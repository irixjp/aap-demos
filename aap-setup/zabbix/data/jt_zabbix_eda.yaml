---
default:
  jt:
    organization: Default
    project: aap-demo
  wf:
    organization: Default

jt:
  - name: EDA_0000_シナリオ操作
    organization: "{{ default.jt.organization }}"
    project: "{{ default.jt.project }}"
    playbook: zabbix-eda/playbooks/scenario_ctrl.yaml
    inventory: docker-host
    credentials:
      - docker-server
    survey_enabled: true
    survey_spec:
      name: 実行するシナリオを指定
      description: ""
      spec:
        - question_name: シナリオを選択
          variable: senario_num
          type: multiplechoice
          choices:
            - "1"
            - "2"
            - "3"
          default: "1"
          required: true
        - question_name: 開始/停止
          variable: senario_mode
          type: multiplechoice
          choices:
            - start
            - end
          default: start
          required: true

  - name: EDA_0001_チケットオープン
    organization: "{{ default.jt.organization }}"
    project: "{{ default.jt.project }}"
    playbook: zabbix-eda/playbooks/redmine_create_issue.yaml
    inventory: localhost

  - name: EDA_0002_状態確認とチケット追記
    organization: "{{ default.jt.organization }}"
    project: "{{ default.jt.project }}"
    playbook: zabbix-eda/playbooks/redmine_check_status_and_add_log.yaml
    inventory: docker-host
    credentials:
      - docker-server
    become_enabled: true

  - name: EDA_0003a_チケットへの結果追加
    organization: "{{ default.jt.organization }}"
    project: "{{ default.jt.project }}"
    playbook: zabbix-eda/playbooks/redmine_add_comment_success.yaml
    inventory: localhost

  - name: EDA_0003b_チケットクローズ
    organization: "{{ default.jt.organization }}"
    project: "{{ default.jt.project }}"
    playbook: zabbix-eda/playbooks/redmine_add_comment_success.yaml
    inventory: localhost

  - name: EDA_0004_チケットクローズ
    organization: "{{ default.jt.organization }}"
    project: "{{ default.jt.project }}"
    playbook: zabbix-eda/playbooks/redmine_add_comment_faild.yaml
    inventory: localhost

  - name: EDA_0005_復旧停止を通知
    organization: "{{ default.jt.organization }}"
    project: "{{ default.jt.project }}"
    playbook: zabbix-eda/playbooks/redmine_add_comment_deny.yaml
    inventory: localhost

wf:
  - name: EDA_Zabbix_Auto_Response
    organization: "{{ default.wf.organization }}"
    extra_vars:
      zabbix_url: http://172.31.47.250:8080/
      redmine_server_url: http://172.31.47.250:8880/
      redmine_api_key: 
      project_id: 1
      tracker_id: 1
    workflow_nodes:
      - identifier: node9999-1
        unified_job_template:
          name: Platform_dayX_9999_jt_test1
          type: job_template
        related:
          success_nodes: []
          failure_nodes: []
          always_nodes: []
      - identifier: node9999-3
        unified_job_template:
          name: Platform_dayX_9999_jt_test3
          type: job_template
        related:
          success_nodes: []
          failure_nodes: []
          always_nodes: []
